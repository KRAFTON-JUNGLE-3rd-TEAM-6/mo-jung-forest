<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/index.css">
    <style>
        /* compatibility for smaller devices */
        body {
            min-width: 360px;
        }
        
        /* compatibility for tablet devices */
        @media (min-width: 820px) {
            .container{
                max-width: 820px;
            }
        }

        .progress {
            background-color: transparent; /* ë°°ê²½ ìƒ‰ìƒì„ íˆ¬ëª…ìœ¼ë¡œ ì„¤ì • */
        }

        .profile-thumbnail {
            height: 3em; /* Adjust the height as needed */
            width: 3em; /* Ensure the width matches the height to create a square */
            border-radius: 50%; /* Create an elliptical shape (50% radius for a perfect ellipse) */
            overflow: hidden;
        }

        .profile-thumbnail img {
            object-fit: cover; /* Crop the image to fill the container */
            width: 100%; /* Ensure the image takes up the full width of the container */
            height: 100%; /* Ensure the image takes up the full height of the container */
        }

        .emoji-reaction-buttons {
            display: flex;
            justify-content: flex-end;
            margin: 10px;
        }

        .btn-emoji-reaction {
            border: none;
            background-color: #eee;
            color: #333;
            border-radius: 20px;
            padding: 2px 16px;
            margin: 0 2px;
            font-size: 20px;
            cursor: pointer;
            width: 80px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
        }

        .emoji-count-field {
            font-size: 14px;
            flex-grow: 1;
        }


        .btn-emoji-reaction:hover {
            background-color: #ddd;
        }

    </style>
    <script>

        $(document).ready(function () {
            // ë¡œê·¸ì¸ ì—¬ë¶€ì™€ í† í° ìœ íš¨ì„± ê²€ì‚¬
            // validate_token_and_check_login();

            // $("#feed-box").empty();
            // showFeed();
            addConfirmEventOnVoteRadio();
            addCharlimitEventOnMessageModal();
            addSubmitEventOnMessageModal();
            addCloseEventOnMessageModal();
            addSubmitEventOnVoteModal();
            addCloseEventOnVoteModal();
        });

        // íˆ¬í‘œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: íˆ¬í‘œ ì‹œ í™•ì¸ ë©”ì„¸ì§€ ì¶œë ¥
        function addConfirmEventOnVoteRadio() {
            $('input[type=radio][name=voteOption]').change(function() {
                if (confirm('ì •ë§ íˆ¬í‘œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    const voteId = "65274b3280920e306bdc1145";      // ì„ì‹œ í•˜ë“œì½”ë”©, ì¹´ë“œHTMLì—ì„œ ë™ì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì•¼ í•¨
                    const optionId = this.value;
                    $.ajax({
                        type: 'POST',
                        url: `http://127.0.0.1:5000/votes/${voteId}/options/${optionId}`,
                        contentType: 'application/json',
                        // data: JSON.stringify(formData),
                        success: function(response) {
                            console.log('Data submitted successfully:', response);
                        },
                        error: function(err) {
                            console.error('Error:', err);
                        }
                    });
                    // íˆ¬í‘œ ê²°ê³¼ ì¹´ë“œë¡œ ê°ˆì•„ë¼ê¸°
                } else {
                    $('input[type=radio][name=voteOption]').prop('checked', false);
                }
            });
        }

        // ë©”ì„¸ì§€ ì‘ì„± ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: ì‹¤ì‹œê°„ ê¸€ì ìˆ˜ ì œí•œ
        function addCharlimitEventOnMessageModal() {
            const messageInput = $('#postMessage-content');
            const charCount = $('#postMessage-charCount');
            const maxLength = 300;

            messageInput.on('input', function () {
                const currentLength = messageInput.val().length;
                charCount.text(`${currentLength}/${maxLength}`);

                if (currentLength > maxLength) {
                    charCount.addClass('text-danger');
                    messageInput.val(messageInput.val().substring(0, maxLength)); // Truncate the text
                    charCount.text(`${maxLength}/${maxLength}`);
                } else {
                    charCount.removeClass('text-danger');
                }
            });
        };

        // ë©”ì„¸ì§€ ì‘ì„± ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: submit ë²„íŠ¼
        function addSubmitEventOnMessageModal() {
            $('#postMessageForm').submit(function (event) {
                event.preventDefault();

                const defaultBtnText = "ë³´ë‚´ê¸°";
                const loadingBtnText = `
                    <div class="spinner-border spinner-border-sm" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                `;
                $('#postMessage-postBtn').html(loadingBtnText);


                const msgRecipient = $('#postMessage-recipient').val();
                const msgContent = $('#postMessage-content').val();
                const formData = {
                    recipient: msgRecipient,
                    content: msgContent
                };

                $.ajax({
                    type: 'POST',
                    url: 'http://127.0.0.1:5000/messages',
                    contentType: 'application/json',
                    data: JSON.stringify(formData),
                    success: function(response) {
                        console.log('Data submitted successfully:', response);
                        $('#postMessage-title').val('');
                        $('#postMessage-content').val('');
                    },
                    error: function(err) {
                        console.error('Error:', err);
                        $('#postMessage-postBtn').html(defaultBtnText);
                    }
                });
            });
        };

        // ë©”ì„¸ì§€ ì‘ì„± ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: close ë²„íŠ¼
        function addCloseEventOnMessageModal() {
            $('#postMessage-closeBtn').click(function () {
                $('#postMessage-title').val('');
                $('#postMessage-content').val('');
            });
        }

        // íˆ¬í‘œ ì œì•ˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: submit ë²„íŠ¼
        function addSubmitEventOnVoteModal() {
            $('#postVoteForm').submit(function (event) {
                event.preventDefault();

                const defaultBtnText = "íˆ¬í‘œ ì œì•ˆ";
                const loadingBtnText = `
                    <div class="spinner-border spinner-border-sm" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                `;
                $('#postVote-postBtn').html(loadingBtnText);

                const voteTitle = $('#postVote-title').val();
                const voteOptions = [];
                $('[id^="postVote-option"]').each((index, element) => {
                    voteOptions.push({
                        optionId: index,
                        content: element.value
                    });
                })
                var formData = {
                    title: voteTitle,
                    option: voteOptions
                };
                
                $.ajax({
                    type: 'POST',
                    url: 'http://127.0.0.1:5000/votes',
                    contentType: 'application/json',
                    data: JSON.stringify(formData),
                    success: function(response) {
                        console.log('Data submitted successfully:', response);
                        $('#postVote-title').val('');
                        $('[id^="postVote-option"]').each((index, element) => {
                            element.value = '';
                        });
                    },
                    error: function(err) {
                        console.error('Error:', err);
                        $('#postVote-postBtn').html(defaultBtnText);
                    }
                });
            });

        };

        // íˆ¬í‘œ ì œì•ˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: close ë²„íŠ¼
        function addCloseEventOnVoteModal() {
            $('#postVote-closeBtn').click(function () {
                $('#postVote-title').val('');
                $('[id^="postVote-option"]').each((index, element) => {
                    element.value = '';
                });
            });
        }

        function showMain(pageNum){
            $.ajax({
                    type: "GET",
                    url: "/mainBoard?page=" + pageNum,
                    data: {},
                    success: function (response) {
                        // HTTP í†µì‹  ì„±ê³µì´ì§€ë§Œ ë©”ì„¸ì§€ê°€ successê°€ ì•„ë‹Œ ê²½ìš° (ë“œë¬¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒ)
                        if (response.result !== "success")
                        return;
                    
                        for (const post of response.data) {
                            console.dir(post);
                            if (post.mode == "MESSAGE"){
                                const recipient = post.recipient;
                                const content = post.content;
                                //let reactionId = data['reactionId'];
                                //let reactions = data['reactions'];  // list
                                makeMessageCard(recipient, content);
                                continue;
                            }
                            if (post.mode == "VOTE") {
                                const title = post.title;
                                const options = post.options;
                                console.log("vote is selected");
                                console.log("optionProportions is: " + post.optionProportions);
                                if (!post.selectedOptionId) {
                                    console.log("user hasn't voted yet");
                                    makeBeforeVoteCard(title, options);
                                    continue;
                                }
                                console.log("user has already voted");
                                makeAfterVoteCard(title, options, post.selectedOptionId);
                                continue;
                            }
                        }
                        
                            // ì„ íƒëœ í˜ì´ì§€ (defalut : 1)
                            // let page = response['page'];

                        },
                    error: function (error) {
                        console.log(error);
                    }
                });
        }

        function makeMessageCard(recipient, content) {
            let tempHtml = `<div class="card mb-3 shadow-lg bg-light" style="height: 216.45px;">
            <div class="card-header">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-right-dots-fill" viewBox="0 0 16 16">
                    <path d="M16 2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h9.586a1 1 0 0 1 .707.293l2.853 2.853a.5.5 0 0 0 .854-.353V2zM5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                </svg>
                ìµëª…ì˜ ì‚¬ìš©ìê°€ <b>${recipient}</b>ì—ê²Œ ë©”ì„¸ì§€ë¥¼ ë‚¨ê²¼ìŠµë‹ˆë‹¤
            </div>
            <div class="card-body d-flex flex-column justify-content-center">
                ${content}
            </div>
            </div>`
            $("#feed-box").append(tempHtml);
        }

        function makeBeforeVoteCard(title, options){

            let tempHtml = `<div class="card mb-3 shadow-lg bg-light" style="height: 216.45px;">
            <div class="card-header">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mailbox2-flag" viewBox="0 0 16 16">
                    <path d="M10.5 8.5V3.707l.854-.853A.5.5 0 0 0 11.5 2.5v-2A.5.5 0 0 0 11 0H9.5a.5.5 0 0 0-.5.5v8h1.5Z"/>
                    <path d="M4 3h4v1H6.646A3.99 3.99 0 0 1 8 7v6h7V7a3 3 0 0 0-3-3V3a4 4 0 0 1 4 4v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a4 4 0 0 1 4-4Zm.585 4.157C4.836 7.264 5 7.334 5 7a1 1 0 0 0-2 0c0 .334.164.264.415.157C3.58 7.087 3.782 7 4 7c.218 0 .42.086.585.157Z"/>
                </svg>
                ìµëª…ì˜ ì‚¬ìš©ìê°€ íˆ¬í‘œë¥¼ ë‚¨ê²¼ìŠµë‹ˆë‹¤: <strong>"${title}"</strong>
            </div>
            <div class="card-body d-flex flex-column justify-content-center">`;
            for(let i = 0; i < options.length;i++){
                let subHtml =`<div class="form-check">
                    <input class="form-check-input" type="radio" name="optionRadio">
                    <label class="form-check-label" for="optionRadio1">
                        ${options['content']}
                    </label>
                </div>`;

                tempHtml += subHtml;
            }

            tempHtml += `</div>`;

            $("#feed-box").append(tempHtml);
        }

        function makeAfterVoteCard(title, options, selectedOptionId){
            let tempHtml = `<h2 class="text-muted">ìµëª…ì˜ ì‚¬ìš©ìê°€ íˆ¬í‘œë¥¼ ë‚¨ê²¼ìŠµë‹ˆë‹¤:<strong>"${title}"</strong> </h2>`;
            let max = 0;
            // for(let i = 0; i < optionCounts.length;i++){
            //     if(optionCounts)
            // }

            for(let i = 0; i < options.length;i++){
                let subHtml =`<div class="progress">
                    <div class="text-muted">${options[i]}</div>
                    <div class="progress-bar" role="progressbar" style="width: 50%;" aria-valuenow="{{ 50 }}" aria-valuemin="0" aria-valuemax="100"></div>
                </div>`;

                tempHtml += subHtml;
            }


            $("#feed-box").append(tempHtml);
        }

        function react(postId, emojiId) {
            const requestEmojiId = parseInt(emojiId);
            console.log("requestEmojiId: ", requestEmojiId);
            const storedEmote = getEmotion(postId);
            console.log("storedEmote: ", storedEmote);

            // ë°˜ì‘ ì´ë ¥ì´ ì—†ëŠ” ê²½ìš° => POST
            if (!storedEmote) {
                console.log("posting...");
                postEmotion(postId, emojiId);
                return;
            }
            // ë°˜ì‘ ì´ë ¥ì´ ìˆëŠ” ê²½ìš°
            // (1) ìš”ì²­ ë°˜ì‘ê³¼ ì €ì¥ ë°˜ì‘ì´ ê°™ë‹¤ë©´ ì·¨ì†Œ ìš”ì²­ => DELETE
            const storedEmojiId = storedEmote.emojiId;
            console.log("storedEmojiId: ", storedEmojiId);
            if (requestEmojiId === storedEmojiId) {
                console.log("deleting...");
                deleteEmotion(postId, requestEmojiId);
                return;
            }
            // (2) ìš”ì²­ ë°˜ì‘ê³¼ ì €ì¥ ë°˜ì‘ì´ ë‹¤ë¥´ë‹¤ë©´ ì—…ë°ì´íŠ¸ ìš”ì²­ => DELETE and POST
            console.log("updating...");
            deleteEmotion(postId, storedEmojiId);
            postEmotion(postId, requestEmojiId);
        }

        function getEmotion(postId) {
            let res;
            $.ajax({
                type: 'GET',
                url: '/reactions/' + postId,
                contentType: 'application/json',
                async: false,
                success: function(response) {
                    console.log('Data submitted successfully:', response);
                    res = response.storedEmote;
                },
                error: function(err) {
                    console.error('Error:', err);
                }
            })
            return res;
        }

        async function postEmotion(postId, emojiId) {
            $.ajax({
                type: 'POST',
                url: '/reactions',
                contentType: 'application/json',
                data: JSON.stringify({
                    postId: postId,
                    emojiId: emojiId
                }),
                success: function(response) {
                    console.log('Data submitted successfully:', response);
                },
                error: function(err) {
                    console.error('Error:', err);
                }
            })
        }

        async function deleteEmotion(postId, emojiId) {
            $.ajax({
                type: 'DELETE',
                url: '/reactions',
                contentType: 'application/json',
                data: JSON.stringify({
                    postId: postId,
                    emojiId: emojiId
                }),
                async: false,
                success: function(response) {
                    console.log('Data submitted successfully:', response);
                },
                error: function(err) {
                    console.error('Error:', err);
                }
            })
        }
        
        function validate_token_and_check_login() {
            $.ajax({
                        type: "GET",
                        url: "/auth/check",
                        contentType: "application/json; charset=utf-8",
                        success: function(response) { 
                            if (response['result'] == 'success') {
                                // ê·¸ëŒ€ë¡œ ìˆëŠ”ë‹¤.
                            } else if(response['result'] == 'afail') {  // 'afail'ì¸ ê²½ìš°, ì•¡ì„¸ìŠ¤ í† í° ì¬ê°±ì‹  ì˜ì‚¬ë¥¼ ë¬¼ì–´ë´„
                                if(confirm("ë¡œê·¸ì¸ ìœ ì§€ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì—°ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?") == true) {
                                    $.ajax({
                                        type: "GET",
                                        url: "/auth/refresh",
                                        contentType: "application/json; charset=utf-8",
                                        success: function(response) {
                                            if (response['result'] == 'success') {  // ì—°ì¥ì— ì„±ê³µí•œ ê²½ìš°
                                                alert('ì—°ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                                            } else {  // 'fail'ì¸ ê²½ìš°, ê°€ì´ë“œ ë©”ì‹œì§€
                                                alert(response['data']);
                                            }
                                        }, error: function(error) {
                                            alert(error);
                                        }
                                    })
                                } else { // í† í° ê°±ì‹ ì„ ì›í•˜ì§€ ì•Šìœ¼ë©´, ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
                                    $.ajax({
                                        type: "GET",
                                        url: "/users/logout",
                                        contentType: "application/json; charset=utf-8",
                                        success: function(response) {
                                            if (response['result'] == 'success') {
                                                alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                                                $(location).attr('href', "{{ url_for('home') }}");
                                            } else {  // 'fail'ì¸ ê²½ìš°, ê°€ì´ë“œ ë©”ì‹œì§€
                                                alert(response['data']);
                                            }
                                            
                                        }, error: function(error) {
                                            alert(error);
                                        }
                                    })
                                }
                            } else if(response['result'] == 'rfail') { // 'rfail'ì¸ ê²½ìš°, ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬        
                            $.ajax({
                                        type: "GET",
                                        url: "/users/logout",
                                        contentType: "application/json; charset=utf-8",
                                        success: function(response) {
                                            if (response['result'] == 'success') {
                                                alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                                                $(location).attr('href', "{{ url_for('home') }}");
                                            } else {  // 'fail'ì¸ ê²½ìš°, ê°€ì´ë“œ ë©”ì‹œì§€
                                                alert(response['data']);
                                            }
                                            
                                        }, error: function(error) {
                                            alert(error);
                                        }
                                    })
                            } else {
                                $(location).attr('href', "{{ url_for('home') }}");
                            }
                        }, error: function(error) {
                            alert(error);
                        }
                    })
        }
    </script>
</head>
<body>
    <!-- top container -->
    <div id="mypage-box" class="container">
        <div class="d-flex justify-content-end">
            <i class="bi bi-person-square" style="font-size: 19px;margin-top: 7px;margin-right: 10px;"></i>
            
            <span id="user-name-header" class="mt-2 text-muted">{{ userName }}</span>
            <span  class="mt-2 text-muted">ë‹˜ ì•ˆë…•í•˜ì„¸ìš”</span>
        </div>
    </div>

    <!-- feed container -->
    <div id="feed-title" class="container d-flex justify-content-end pt-4 pb-2">
        <h1 id="board-title-big" class="text-success col-9">ëª¨ì •ìˆ² í”¼ë“œ</h1>
        <div>
            <button type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#postMessageModal">ë©”ì„¸ì§€ ì‘ì„±</button>
            <button type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#postVoteModal">íˆ¬í‘œ ì œì•ˆ</button>
        </div>
    </div>
    </div>
    <div id="feed-box" class="container">
        <!-- ê°œë°œìš© ì¹´ë“œ 1: ë©”ì„¸ì§€ -->
        <div class="card mb-3 shadow-lg bg-light" style="height: 216.45px;">
            <div class="card-header">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-right-dots-fill" viewBox="0 0 16 16">
                    <path d="M16 2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h9.586a1 1 0 0 1 .707.293l2.853 2.853a.5.5 0 0 0 .854-.353V2zM5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                </svg>
                ìµëª…ì˜ ì‚¬ìš©ìê°€ <b>ê¹€ìƒìš°</b>ì—ê²Œ ë©”ì„¸ì§€ë¥¼ ë‚¨ê²¼ìŠµë‹ˆë‹¤
            </div>
            <div class="card-body d-flex flex-column justify-content-center">
                ì˜ìƒê²¼ì–´ìš”
            </div>
            <div class="emoji-reaction-buttons">
                <button class="btn btn-emoji-reaction" value="0" onclick="react('65274b3280920e306bdc1145', 0)"> <!-- ì½”ë“œ ìŠ¤ë‹ˆí« ìƒì„± ì‹œ postIdê°€ stringìœ¼ë¡œ ë“¤ì–´ê°€ì•¼ í•¨ --> 
                    <div class="emoji-btn-field">â¤ï¸</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction" value="1" onclick="react('65274b3280920e306bdc1145', 1)">
                    <div class="emoji-btn-field">ğŸ¤£</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction" value="2" onclick="react('65274b3280920e306bdc1145', 2)">
                    <div class="emoji-btn-field">ğŸ˜ª</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction" value="3" onclick="react('65274b3280920e306bdc1145', 3)">
                    <div class="emoji-btn-field">ğŸ’¢</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction" value="4" onclick="react('65274b3280920e306bdc1145', 4)">
                    <div class="emoji-btn-field">ğŸ”¥</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction" value="5" onclick="react('65274b3280920e306bdc1145', 5)">
                    <div class="emoji-btn-field">â“</div>
                    <div class="emoji-count-field">0</div>
                </button>
            </div>
        </div>
        <!-- ê°œë°œìš© ì¹´ë“œ 2: íˆ¬í‘œ ì „ -->
        <div class="card mb-3 shadow-lg bg-light" style="height: 216.45px;">
            <div class="card-header">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mailbox2-flag" viewBox="0 0 16 16">
                    <path d="M10.5 8.5V3.707l.854-.853A.5.5 0 0 0 11.5 2.5v-2A.5.5 0 0 0 11 0H9.5a.5.5 0 0 0-.5.5v8h1.5Z"/>
                    <path d="M4 3h4v1H6.646A3.99 3.99 0 0 1 8 7v6h7V7a3 3 0 0 0-3-3V3a4 4 0 0 1 4 4v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a4 4 0 0 1 4-4Zm.585 4.157C4.836 7.264 5 7.334 5 7a1 1 0 0 0-2 0c0 .334.164.264.415.157C3.58 7.087 3.782 7 4 7c.218 0 .42.086.585.157Z"/>
                </svg>
                ìµëª…ì˜ ì‚¬ìš©ìê°€ íˆ¬í‘œë¥¼ ë‚¨ê²¼ìŠµë‹ˆë‹¤: <b>"íƒ•í›„ë£¨vsíƒ•ìˆ˜ìœ¡"</b>
            </div>
            <div class="card-body d-flex flex-column justify-content-center">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="voteOption" value="0">
                    <label class="form-check-label">
                        íƒ•í›„ë£¨
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="voteOption" value="1">
                    <label class="form-check-label">
                        íƒ•ìˆ˜ìœ¡
                    </label>
                </div>
            </div>
            <div class="emoji-reaction-buttons">
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">â¤ï¸</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ¤£</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ˜ª</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ’¢</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ”¥</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">â“</div>
                    <div class="emoji-count-field">0</div>
                </button>
            </div>
        </div>
        <!-- ê°œë°œìš© ì¹´ë“œ 3: íˆ¬í‘œ í›„ -->
        <div class="card mb-3 shadow-lg bg-light" style="height: 216.45px;">
            <div class="card-header text-muted">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mailbox2" viewBox="0 0 16 16">
                    <path d="M9 8.5h2.793l.853.854A.5.5 0 0 0 13 9.5h1a.5.5 0 0 0 .5-.5V8a.5.5 0 0 0-.5-.5H9v1z"/>
                    <path d="M12 3H4a4 4 0 0 0-4 4v6a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V7a4 4 0 0 0-4-4zM8 7a3.99 3.99 0 0 0-1.354-3H12a3 3 0 0 1 3 3v6H8V7zm-3.415.157C4.42 7.087 4.218 7 4 7c-.218 0-.42.086-.585.157C3.164 7.264 3 7.334 3 7a1 1 0 0 1 2 0c0 .334-.164.264-.415.157z"/>
                </svg>
                ì´ë¯¸ íˆ¬í‘œí•˜ì…¨ìŠµë‹ˆë‹¤: <b>"íƒ•í›„ë£¨vsíƒ•ìˆ˜ìœ¡"</b>
            </div>
            <div class="card-body d-flex flex-column justify-content-center">
                <div>
                    <div class="text-muted">íƒ•í›„ë£¨</div>
                    <div class="progress">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 25%;" aria-valuenow="{{ 25 }}" aria-valuemin="0" aria-valuemax="100">1í‘œ</div>
                    </div>
                </div>
                <div>
                    <div class="text-muted">íƒ•ìˆ˜ìœ¡</div>
                    <div class="progress">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 25%;" aria-valuenow="{{ 25 }}" aria-valuemin="0" aria-valuemax="100">1í‘œ</div>
                    </div>
                </div>
            </div>
            <div class="emoji-reaction-buttons">
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">â¤ï¸</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ¤£</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ˜ª</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ’¢</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">ğŸ”¥</div>
                    <div class="emoji-count-field">0</div>
                </button>
                <button class="btn btn-emoji-reaction">
                    <div class="emoji-btn-field">â“</div>
                    <div class="emoji-count-field">0</div>
                </button>
            </div>
        </div>
    </div>

    <!-- pagination container -->
    <div id="pagination-box" class="container">
        <h1>í˜ì´ì§€ë„¤ì´ì…˜ ì˜ˆì œ</h1>
        <ul class="pagination">
            {#
            <li class="page-item"><a class="page-link" href="{{ url_for('index', page=1) }}">ì´ì „</a></li>
            {% for page_num in range(1, 5) %}
            <li class="page-item {% if page_num == current_page %}active{% endif %}">
                <a class="page-link" href="{{ url_for('index', page=page_num) }}">{{ page_num }}</a>
            </li>
            {% endfor %}
            <li class="page-item"><a class="page-link" href="{{ url_for('index', page=total_pages) }}">ë‹¤ìŒ</a></li>
            #}
        </ul>
    </div>

    <!-- Hidden Modals -->
    <!-- ë©”ì„¸ì§€ ì‘ì„± ëª¨ë‹¬ ì°½ -->
    <div class="modal fade" id="postMessageModal" tabindex="-1" aria-labelledby="postMessageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <form id="postMessageForm">
                    <div class="modal-body">
                        <div class="d-flex align-items-center mb-1">
                            <div class="postMessage-iconField">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope text-success" viewBox="0 0 16 16">
                                    <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z" />
                                </svg>
                                ë°›ëŠ” ì‚¬ëŒ:
                            </div>
                            <div class="postMessage-recipientField">
                                <input type="text" id="postMessage-recipient" class="form-control border-0" placeholder="ë°›ëŠ” ì‚¬ëŒì„ ì…ë ¥í•˜ì„¸ìš”" required>
                            </div>
                        </div>
                        <div class="postMessage-contentField">
                            <textarea class="form-control" id="postMessage-content" placeholder="ë©”ì„¸ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" rows="6" required></textarea>
                            <div id="postMessage-charCount" class="text-end">0/300</div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="postMessage-closeBtn" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                        <button type="submit" id="postMessage-postBtn" class="btn btn-success">ë³´ë‚´ê¸°</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- íˆ¬í‘œ ì œì•ˆ ëª¨ë‹¬ ì°½ -->
    <div class="modal fade" id="postVoteModal" tabindex="-1" aria-labelledby="postVoteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <form id="postVoteForm">
                    <div class="modal-body">
                        <div class="d-flex align-items-center mb-1">
                            <div class="postVote-iconField">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ui-checks text-success" viewBox="0 0 16 16">
                                    <path d="M7 2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-1zM2 1a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2zm0 8a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2H2zm.854-3.646a.5.5 0 0 1-.708 0l-1-1a.5.5 0 1 1 .708-.708l.646.647 1.646-1.647a.5.5 0 1 1 .708.708l-2 2zm0 8a.5.5 0 0 1-.708 0l-1-1a.5.5 0 0 1 .708-.708l.646.647 1.646-1.647a.5.5 0 0 1 .708.708l-2 2zM7 10.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-1zm0-5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 8a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
                                </svg>
                                íˆ¬í‘œ ì£¼ì œ:
                            </div>
                            <div class="postVote-titleField">
                                <input type="text" id="postVote-title" class="form-control border-0" placeholder="ì£¼ì œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                            </div>
                        </div>
                        <div class="postVote-optionField">
                            <input type="text" id="postVote-option1" class="form-control mb-1" placeholder="1ì•ˆ" required>
                            <input type="text" id="postVote-option2" class="form-control mb-1" placeholder="2ì•ˆ" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="postVote-closeBtn" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                        <button type="submit" id="postVote-postBtn" class="btn btn-success">íˆ¬í‘œ ì œì•ˆ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
</body>
</html>